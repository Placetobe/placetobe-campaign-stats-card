<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../placetobe-styles/placetobe-styles.html">
<link rel="import" href="../placetobe-button/placetobe-button.html">
<link rel="import" href="../placetobe-campaign-progress-bar/placetobe-campaign-progress-bar.html">
<link rel="import" href="../caas-campaign-stats/caas-campaign-stats.html">

<!--
`placetobe-campaign-stats-card`
Placetobe Campaign Statistics Card

@demo demo/index.html 
-->

<dom-module id="placetobe-campaign-stats-card">
  <template>
    <style>
      :host {
        display: block;
        --placetobe-text-color: red;
      }

      :host section {

      }

      :host main, :host footer {
        display: block;
      }

      :host main {
        background-color: var(--placetobe-color-gray);
        border-radius: 3px 3px 0 0;
        padding: 0;
        display: flex;
        flex-direction: column;
      }

      :host main div {
        flex: 1;
        padding: 9px 18px;
        display: flex;
        justify-content: flex-end;
        flex-direction: column;
      }

      :host main article {
        color: var(--placetobe-color-darkblue);
      }

      #funded-capital {
        color: var(--placetobe-color-green);
        padding-bottom: 9px;
      }

      :host footer {
        background-color: var(--placetobe-color-darkblue);
        height: 100px;
        width: 100%;
        border-radius: 0 0 3px 3px;
        padding: 18px;
        box-sizing: border-box;
        display: flex;
        justify-content: center;
        align-items: center;
      }

      :host footer placetobe-campaign-progress-bar {
        flex: 1;
        margin-top: -24px;
      }

      :host footer placetobe-button {
        flex: none;
        margin-left: 18px;
      }

      @media(max-width: 600px) {
        
        #funded-capital {
          @apply(--placetobe-font-heading3-bold-small);
        }

        :host main article {
          @apply(--placetobe-font-body-serif-small);
        }

        :host main article strong {
          @apply(--placetobe-font-body-serif-small-bold);
        }
      }

      @media(min-width: 600px) {
        
        #funded-capital {
          @apply(--placetobe-font-heading3-bold-large);
        }

        :host main {
          flex-direction: row;
          align-items: stretch;
          padding: 18px 0;
        }

        :host main article {
          @apply(--placetobe-font-body-serif-large);
        }

        :host main article strong {
          @apply(--placetobe-font-body-serif-large-bold);
        }

        :host main div {
          padding-top: 0;
          padding-bottom: 0;
        }

        :host main div:not(:first-of-type) {
          border-left: 1px solid rgb(151, 151, 151);
        }

      }

    </style>

    <caas-campaign-stats
      api-endpoint="[[apiEndpoint]]"
      campaign-id="[[campaignId]]"
      currently-funded="{{currentlyFunded}}"
      required-funding="{{requiredFunding}}"
      maximum-funding="{{maximumFunding}}"
      nominal-interest-rate="{{nominalInterestRate}}"
      nominal-interest-rate-per-year="{{nominalInterestRatePerYear}}"
      effective-interest-rate-per-year="{{effectiveInterestRatePerYear}}"
      interest-rate-refund-terms="{{interestRateRefundTerms}}"
      number-of-funders="{{numberOfFunders}}"
      average-funding="{{averageFunding}}"
      start-time="{{campaignStartTime}}"
    ></caas-campaign-stats>

    <section>
      <main>
        <div>
          <h3 id="funded-capital">€[[currentlyFunded]]</h3>
          <article>
            Minimaal: <strong>€[[requiredFunding]]</strong><br>
            tot maximaal: <strong>€[[maximumFunding]]</strong>
          </article>
        </div>
        <div>
          <article>
            <!--<strong>Lening campagne</strong><br>-->
            <strong>[[nominalInterestRate]]%</strong> totaalrendement<br>
            <strong>[[nominalInterestRatePerYear]]%</strong> nominaal jaarrendement<br>
            <strong>[[effectiveInterestRatePerYear]]%</strong> effectief jaarrendement
          </article>
        </div>
        <div>
          <article>
            Looptijd is <strong>[[interestRateRefundTerms]] maanden</strong><br>
            Start op <strong>[[_parseTimeToDate(campaignStartTime)]]</strong><br>
            <strong>[[numberOfFunders]]</strong> investeerders<br>
            Gemiddelde investering: <strong>€[[averageFunding]]</strong>
          </article>
        </div>
      </main>
      <footer>
        <placetobe-campaign-progress-bar
          required-funding="[[requiredFunding]]"
          maximum-funding="[[maximumFunding]]"
          currently-funded="[[currentlyFunded]]"
        ></placetobe-campaign-progress-bar>
        <placetobe-button>Investeren</placetobe-button>
      </footer>
    </section>

  </template>

  <script>
    Polymer({

      is: 'placetobe-campaign-stats-card',

      properties: {
        
        apiEndpoint: {
          type: String,
          value: null
        },

        campaignId: {
          type: String,
          value: null
        }

      },

      _parseTimeToDate: function(time) {
        var date = new Date(time);
        var day = date.getDate();
        var month = date.getMonth()+1;
        var year = date.getFullYear();
        return (day < 10 ? '0' + day : day) + '-' + (month < 10 ? '0' + month : month) + '-' + year; 
      }

    });
  </script>
</dom-module>
